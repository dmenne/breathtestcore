<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Core functions to read and fit 13C time series from breath tests • breathtestcore</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">breathtestcore</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dmenne/breathtestcore">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    

<div id="breathtestcore-analyze-13c-time-series-from-breath-tests" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#breathtestcore-analyze-13c-time-series-from-breath-tests" class="anchor"></a>breathtestcore: Analyze 13C time series from breath tests</h1></div>
<p>Dieter Menne<br>
Menne Biomed Consulting Tübingen, Germany<br><a href="http://www.menne-biomed.de" class="uri">http://www.menne-biomed.de</a></p>
<p><a href="mailto:dieter.menne@menne-biomed.de">dieter.menne@menne-biomed.de</a></p>
<p>This is a reboot of R package <a href="https://github.com/dmenne/d13cbreath">dmenne/d13cbreath</a> with better separation of functions. To test some of the functions with sample data or your own data, try the <a href="https://apps.menne-biomed.de/breathtestshiny">online demo</a>. Issues can be reported <a href="https://github.com/dmenne/breathtestcore/issues">here</a>.</p>
<div id="what-it-does" class="section level2">
<h2 class="hasAnchor">
<a href="#what-it-does" class="anchor"></a>What it does</h2>
<ul>
<li>Reads several file formats of 13C data: IRIS/Wagner (composite and CSV), BreathID and generic CSV</li>
<li>Fits Beta-Exponential nonlinear function using <code>nls</code>, which gives successful estimates for 90% of PDR curves</li>
<li>Computes population fit with <code>nlme</code> using all data in database</li>
<li>Computes Bayesian non-linear population fit with Stan for multiple records (refactored to package dmenne/breathteststan)</li>
<li>Computes prior-constrained Bayesian non-linear fit for single records (refactored to package <a href="https://github.com/dmenne/breathteststan">dmenne/breathteststan</a>)</li>
<li>Includes an extensive data set of 13C records from the University Hospital of Zürich<br>
</li>
<li>
<a href="http://menne-biomed.de/blog/breath-test-stan">A comparison of results with nls, nlme</a> and Bayesian <a href="http://www.mc-stan.org">Stan</a>.</li>
<li>See the example in the documentation of <code>t50BluckCoward</code> for a comparison with published data. Most cases agree with those published here, but there are some exceptions?</li>
</ul>
</div>
<div id="sponsors-and-supporters" class="section level2">
<h2 class="hasAnchor">
<a href="#sponsors-and-supporters" class="anchor"></a>Sponsors and supporters</h2>
<p>The software is being developed in cooperation with the ETH, the Department of Gastroenterology of the University Hospital of Zürich, and Claraspital Basel. Thanks to Andreas Steingötter, Benjamin Misselwitz, Mark Fox and Werner Schwizer.</p>
</div>
<div id="how-to-install" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-install" class="anchor"></a>How to install</h2>
<p>To install the functions, use</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"breathtestcore"</span>,<span class="st">"dmenne"</span>)
<span class="co"># In case you want to use the fancy Stan-based methodes</span>
devtools::<span class="kw">install_github</span>(<span class="st">"breathteststan"</span>,<span class="st">"dmenne"</span>)
<span class="co"># And here the still rudimentary web GUI</span>
devtools::<span class="kw">install_github</span>(<span class="st">"breathtestshiny"</span>,<span class="st">"dmenne"</span>)</code></pre></div>
</div>
<div id="usage-example" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-example" class="anchor"></a>Usage example</h2>
<p>This example is from the documentation of function <code>nlme_fit</code>.</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="kw">library</span>(breathtestcore)    
d =<span class="st"> </span><span class="kw"><a href="reference/simulate_breathtest_data.html">simulate_breathtest_data</a></span>(<span class="dt">n_records =</span> <span class="dv">3</span>, <span class="dt">noise =</span> <span class="fl">0.2</span>, <span class="dt">seed =</span> <span class="dv">4711</span>)
data =<span class="st"> </span><span class="kw"><a href="reference/cleanup_data.html">cleanup_data</a></span>(d$data)
fit =<span class="st"> </span><span class="kw"><a href="reference/nlme_fit.html">nlme_fit</a></span>(data)
<span class="kw">plot</span>(fit) <span class="co"># calls plot.breathtestfit</span></code></pre></div>
<p>For additional examples, see the folder <code>tests/testthat</code> of the source package.</p>
</div>
<div id="previous-and-planned-work" class="section level2">
<h2 class="hasAnchor">
<a href="#previous-and-planned-work" class="anchor"></a>Previous and planned work</h2>
<p>The core fitting functions and the Stan variants are quite stable and can be used to analyze your breath test data with R. For the Stan variants, additional models that give credible intervals for differences between groups are planned. The <a href="https://shiny.rstudio.com">Shiny-based web app</a> with reporting, <a href="https://apps.menne-biomed.de/breathtestshiny">online demo here</a>, is work in progress.</p>
<p><strong>Reference</strong>:</p>
<ul>
<li><p>Ghoos, Y. F., B. D. Maes, B. J. Geypens, G. Mys, M. I. Hiele, P. J. Rutgeerts, and G. Vantrappen. 1993. “Measurement of Gastric Emptying Rate of Solids by Means of a Carbon-Labeled Octanoic Acid Breath Test.” <em>Gastroenterology</em> 104 (6). Department of Medicine, University Hospital Gasthuisberg, Belgium.: 1640–7.</p></li>
<li><p>Maes, B. D., B. J. Geypens, Y. F. Ghoos, M. I. Hiele, and P. J. Rutgeerts. 1998. “13C-Octanoic Acid Breath Test for Gastric Emptying Rate of Solids.” <em>Gastroenterology</em> 114 (4): 856–59.</p></li>
<li><p>Bluck LJC (2009) Recent advances in the interpretation of the 13C octanoate breath test for gastric emptying. J. Breath Res. 3, <a href="http://iopscience.iop.org/1752-7163/3/3/034002/" class="uri">http://iopscience.iop.org/1752-7163/3/3/034002/</a></p></li>
<li><p>Bluck, LJC, Jackson S, Vlasakakis G, Mander A (2011) Bayesian hierarchical methods to interpret the 13C-octanoic acid breath test for gastric emptying. Digestion 83_96-107.</p></li>
</ul>
</div>
</div>

  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/dmenne/breathtestcore">https://​github.com/​dmenne/​breathtestcore</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Dieter Menne <br><small class="roles"> Author, maintainer </small> </li>
<li>University Hospital of Zurich, Dep. Gastroenterology <br><small class="roles"> Copyright holder, funder </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/dmenne/breathtestcore"><img src="https://travis-ci.org/dmenne/breathtestcore.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://coveralls.io/github/dmenne/breathtestcore?branch=master"><img src="https://coveralls.io/repos/github/dmenne/breathtestcore/badge.svg?branch=master" alt="Coverage Status"></a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Dieter Menne, University Hospital of Zurich, Dep. Gastroenterology.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
