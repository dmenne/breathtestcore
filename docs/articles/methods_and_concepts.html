<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Methods and concepts • breathtestcore</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">breathtestcore</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/breathtestcore.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_formats.html">Data formats in package breathtestcore</a>
    </li>
    <li>
      <a href="../articles/methods_and_concepts.html">Methods and concepts</a>
    </li>
    <li>
      <a href="../articles/using_breathtestcore.html">Using breathtestcore functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dmenne/breathtestcore">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Methods and concepts</h1>
                        <h4 class="author">Dieter Menne, Menne Biomed Consulting Tuebingen, <a href="mailto:dieter.menne@menne-biomed.de">dieter.menne@menne-biomed.de</a>
</h4>
            
          </div>

    
    
<div class="contents">
<div id="a-heretical-view-on-13c-breath-test" class="section level1">
<h1 class="hasAnchor">
<a href="#a-heretical-view-on-13c-breath-test" class="anchor"></a>A heretical view on <sup>13</sup>C breath test</h1>
<p>For normative documentation of <sup>13</sup>C breath test data analysis to quantify gastric emptying, see the literature given in the documentation of <code><a href="../reference/exp_beta.html">exp_beta()</a></code>, <code><a href="../reference/t50_maes_ghoos.html">t50_maes_ghoos()</a></code> and <code>t50_bluck_coward</code>. Below, I present a slightly different viewpoint on the pharmakokinetics of breath test time series.</p>
<p>But first have a look at the Maes/Ghoos method (<span class="citation">Ghoos et al. (1993)</span>) as it is currently used. Alternatives are discussed in the <a href="#secondlook">next section</a>.</p>
<div id="current-concepts" class="section level2">
<h2 class="hasAnchor">
<a href="#current-concepts" class="anchor"></a>Current concepts</h2>
<p>Within the standard framework implemented in this package, data are fitted to an exponential beta function</p>
<p><span class="math display">\[{PDR} = m*{dose}*k*\beta(1-e^{-k*minute})^{(\beta - 1)}*e^{-k*minute}\]</span></p>
<p>Written in R code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp_beta =<span class="st"> </span><span class="cf">function</span>(minute,dose,m,k,beta) {
     m<span class="op">*</span>dose<span class="op">*</span>k<span class="op">*</span>beta<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>minute))<span class="op">^</span>(beta<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>minute)
}</code></pre></div>
<p>The figure below shows examples of emptying curves. The so-called lag time of the Maes/Ghoos method is at the time of the maximum. Calling this “lag” is a highly confusing definition; technically, lag is the time until a first noticable rise occurs in the curve, best illustrated by the blue curves with <code>beta = 8</code>, which has an estimated lag of about 15 minutes. If one looks more closely, even this definition is misleading, because the curves with higher beta are not zero, but start to rise from the origin like a polynomial curve with a power of <code>beta - 1</code>. A real lag would be best illustrated by a curve shifted to the right by <code>t_lag</code> and pdr values of 0 for <code>t &lt; t_lag</code>, indicating a real physical transport of the meal from the stomach to the small intestine.</p>
<p>In practice, when <sup>13</sup>C curves are fitted, <code>beta</code> is typically in the range of 1.5 and 2.5; values of <code>beta</code> near 1 often lead to instabilities and are protected by priors in the <a href="%60breathteststan::stan_fit()%60">Bayesian fits</a> implemented in the separate package <code>breathteststan</code>.</p>
<div class="figure">
<img src="methods_and_concepts_files/figure-html/unnamed-chunk-3-1.png" alt="Examples of exponential beta functions used to fit breath test curves. _Bottom-up arrow_: Maes/Ghoos lag time. _Top-down arrow_: Maes/Ghoos half emptying time." width="576"><p class="caption">
Examples of exponential beta functions used to fit breath test curves. <em>Bottom-up arrow</em>: Maes/Ghoos lag time. <em>Top-down arrow</em>: Maes/Ghoos half emptying time.
</p>
</div>
<p>The half-emptying time in the definition of Maes/Ghoos is the time where the area under curve (AUC) is half the AUC extrapolated to infinity. In pharmakokinetics, it is the time where half of the bioavailable <sup>13</sup>C has been metabolized, and certainly is affected by gastric emptying, but also by the pharmacokinetics of <sup>13</sup>C bound in octanoate/acetate.</p>
<div class="figure">
<img src="methods_and_concepts_files/figure-html/unnamed-chunk-4-1.png" alt="The half-emptying time in the definition of Maes/Ghoos is the time where the area under curve (AUC) is half of the AUC under the curve extrapolated to infinity." width="384"><p class="caption">
The half-emptying time in the definition of Maes/Ghoos is the time where the area under curve (AUC) is half of the AUC under the curve extrapolated to infinity.
</p>
</div>
</div>
<div id="secondlook" class="section level2">
<h2 class="hasAnchor">
<a href="#secondlook" class="anchor"></a>A second look</h2>
<p>The half-emptying time determined with the <sup>13</sup>C breath test method correlates to some extend with gastric emptying in within subject measurements, but it is not more than a surrogate gastric emptying times measured by MRI (with secretion) or scintigraphy (meal-only). For data set <code>usz_13c_d</code> in this package, MRI emptying data are available and can be compared with <a href="https://dmenne.github.io/breathtestcore/reference/usz_13c_d.html#examples">breath test data</a>. The type of meal strongly biases the estimates because of the the dependency on lipophilic/lipophobic layering; comparing different meal types is not reliable even within-subject, and less so between-subject.</p>
<p>Many attempts have been made to extract more information from the emptying curve, and to correct for the overall too high values; the Bluck-Coward method implemented in this package is one of them, but the <a href="https://dmenne.github.io/breathtestcore/reference/usz_13c_d.html#examples">results</a> are are even more inconsistent with those from MRI than those from the Maes/Ghoos method. I do not know of any publication which has used rigorous statistical tests such as statistical cross-validation and validation with different meal types to show that some method gives “better” results than the default Maes/Ghoos</p>
<blockquote>
<p>In the following, I argue that there is nothing to gain from playing with “better” methods to fit the current breath test time series. Additional per-subject information must be aquired to separate acetate pharmacokinetics from gastric empyting, which is physical transport.</p>
</blockquote>
<div id="acetate-pharmacology" class="section level3">
<h3 class="hasAnchor">
<a href="#acetate-pharmacology" class="anchor"></a>Acetate pharmacology</h3>
<p>Assume we do not mix the labelled acetate with the meal, but hide it in a enteric tablet as it is used for PPI. The pill will quickly disolve in the duodenum or small intestine, mimicing a one-time dose. Following standard pharmacokinetics, this will lead to a first-order compartmental model of the following form:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foc =<span class="st"> </span><span class="cf">function</span>(minute, t_lag, dose, clearance, k1, k2)  {
  <span class="cf">if</span> (minute <span class="op">&lt;</span><span class="st"> </span>t_lag) <span class="kw">return</span>(<span class="dv">0</span>)
  ret =<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.0</span>, <span class="dt">length =</span> <span class="kw">length</span>(minute))
  minute =<span class="st"> </span>minute <span class="op">-</span><span class="st"> </span>t_lag
  norm =<span class="st"> </span>dose <span class="op">*</span><span class="st"> </span>k1 <span class="op">*</span><span class="st"> </span>k2<span class="op">/</span>(clearance <span class="op">*</span><span class="st"> </span>(k2<span class="op">-</span>k1)) 
  norm <span class="op">*</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>k1 <span class="op">*</span><span class="st"> </span>(minute <span class="op">-</span><span class="st"> </span>t_lag)) <span class="op">-</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>k2 <span class="op">*</span><span class="st"> </span>(minute <span class="op">-</span><span class="st"> </span>t_lag))))
  
}</code></pre></div>
<p>You can find the above formula in all standard texts on pharmacokinetics (<span class="citation">Gabrielsson and Weiner (2006)</span>) or in (<span class="citation">Pinheiro and Bates (2000)</span>) as function <code><a href="http://www.rdocumentation.org/packages/stats/topics/SSfol">stats::SSfol()</a></code>. The normalization constant in the function is not very interesting since it does not depend on time, therefore are <code>dose</code> and <code>clearance</code> will be set to fixed values to simplify the presentation.</p>
<p>Forget the decorative stuff: the response the difference between two exponential functions:</p>
<p><span class="math display">\[{foc} =  e^{-k1 * {minute}} - e^{-k2 * {minute}}\]</span></p>
<p>In the above formula, I have added a term <code>t_lag</code> which shifts the curve to the right and sets all values before <code>t_lag</code> to zero.</p>
<p><a href="https://en.wikipedia.org/wiki/Pharmacokinetics#/media/File:Linear_PK_Example.png" class="uri">https://en.wikipedia.org/wiki/Pharmacokinetics#/media/File:Linear_PK_Example.png</a></p>
</div>
</div>
<div id="why-no-wagner-nelson" class="section level2">
<h2 class="hasAnchor">
<a href="#why-no-wagner-nelson" class="anchor"></a>Why no Wagner-Nelson?</h2>
<p>A popular alternative when curve fitting does not work is the Wagner-Nelson method which uses non-parametric approaches for the initial slope. However, it makes a assumption about the terminal slope being the same for all subject (k=0.01/min, 0.65/h). Since this assumption strongly affects the estimate of the half-emptying time, there is little justification to use the Wagner-Nelson method.</p>
</div>
<div id="fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting" class="anchor"></a>Fitting</h2>
</div>
<div id="citations" class="section level2">
<h2 class="hasAnchor">
<a href="#citations" class="anchor"></a>Citations</h2>
<p>From blog of Dieter Menne: <a href="http://menne-biomed.de/blog/breath-test-stan">A comparison of results with nls, nlme</a> and Bayesian <a href="http://www.mc-stan.org">Stan</a>.</p>
<div id="refs" class="references">
<div id="ref-Gabrielsson2006">
<p>Gabrielsson, Johan, and Dan Weiner. 2006. <em>Pharmacokinetic &amp; Pharmacodynamic Data Analysis : Concepts and Applications</em>. 4. ed., rev. and expanded. PK/Pd Data Analysis: Concepts and Applications. Stockholm: Swedish Pharmaceutical Press.</p>
</div>
<div id="ref-Ghoos1993">
<p>Ghoos, Y. F., B. D. Maes, B. J. Geypens, G. Mys, M. I. Hiele, P. J. Rutgeerts, and G. Vantrappen. 1993. “Measurement of Gastric Emptying Rate of Solids by Means of a Carbon-Labeled Octanoic Acid Breath Test.” <em>Gastroenterology</em> 104 (6). Department of Medicine, University Hospital Gasthuisberg, Belgium.: 1640–7.</p>
</div>
<div id="ref-R:PinheiroBates2000">
<p>Pinheiro, Jose C., and Douglas M. Bates. 2000. <em>Mixed-Effects Models in S and S-Plus</em>. Springer.</p>
</div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#a-heretical-view-on-13c-breath-test">A heretical view on <sup>13</sup>C breath test</a><ul class="nav nav-pills nav-stacked">
<li><a href="#current-concepts">Current concepts</a></li>
      <li><a href="#secondlook">A second look</a></li>
      <li><a href="#why-no-wagner-nelson">Why no Wagner-Nelson?</a></li>
      <li><a href="#fitting">Fitting</a></li>
      <li><a href="#citations">Citations</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dieter Menne, Menne Biomed Consulting Tübingen</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
